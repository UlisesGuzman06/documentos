openapi: 3.1.0
info:
  title: HUBCERTIFICADOS — ObtenerCertificadoPost
  version: "1.00"
  description: |
    Ejecuta un certificado y devuelve el **PDF (Base64)**.
    Fuente: US-1309 *ObtenerCertificadoPost* (V.01.00).
servers:
  - url: https://{nodoXroad}
    description: Base X-Road
    variables:
      nodoXroad:
        default: xroad-test.mendoza.gov.ar
tags:
  - name: HubCertificados
components:
  parameters:
    XRoadClient:
      name: X-Road-Client
      in: header
      required: true
      schema: { type: string }
    XRoadUserId:
      name: X-Road-userid
      in: header
      required: false
      schema: { type: string }
    XRoadIssue:
      name: X-Road-Issue
      in: header
      required: true
      schema: { type: string }
      description: "Identificador único (UUID v4 recomendado). Admite prefijos: NombreApp-<uuid>."
  schemas:
    Parametro:
      type: object
      properties:
        nombre: { type: string }
        valor: { type: string }
      required: [nombre, valor]
    ObtenerCertRequest:
      type: object
      additionalProperties: false
      properties:
        ticket: { type: string, description: "API Key" }
        usuario: { type: string }
        parametros:
          type: array
          items: { $ref: "#/components/schemas/Parametro" }
        certificado: { type: integer }
        issue: { type: string }
      required: [ticket, usuario, certificado, issue]
    ObtenerCertResponseOk:
      type: object
      properties:
        respuestaOK: { type: boolean, enum: [true] }
        msgErr: { type: string }
        archivo: { type: string, description: "PDF Base64" }
      required: [respuestaOK, archivo]
    ObtenerCertResponseError:
      type: object
      properties:
        archivo: { type: string }
        respuestaOK: { type: boolean, enum: [false] }
        msgError: { type: string }
      required: [respuestaOK, msgError]
paths:
  /mendoza/DIC/002/HUBCERTIFICADOS/ObtenerCertificadoPost_dev:
    post:
      tags: [HubCertificados]
      summary: Obtener certificado (TEST)
      operationId: obtenerCertificadoPostDev
      parameters:
        - $ref: "#/components/parameters/XRoadClient"
        - $ref: "#/components/parameters/XRoadUserId"
        - $ref: "#/components/parameters/XRoadIssue"
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: "#/components/schemas/ObtenerCertRequest" }
            examples:
              ejemplo:
                value:
                  ticket: "afcf4a74eadd74a03be4fae671f72726341201180"
                  usuario: "app001"
                  parametros: [{ nombre: "dni", valor: "46523478" }]
                  certificado: 4
                  issue: "issuex"
      responses:
        "200":
          description: Único HTTP documentado.
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: "#/components/schemas/ObtenerCertResponseOk"
                  - $ref: "#/components/schemas/ObtenerCertResponseError"
              examples:
                ok:
                  value:
                    respuestaOK: true
                    msgErr: ""
                    archivo: "JVBERi0xLjQK..."
                error:
                  value:
                    archivo: ""
                    respuestaOK: false
                    msgError: "texto descriptivo del error"
